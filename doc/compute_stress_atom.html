<HTML>
<CENTER><A HREF = "http://lammps.sandia.gov">LAMMPS WWW Site</A> - <A HREF = "Manual.html">LAMMPS Documentation</A> - <A HREF = "Section_commands.html#comm">LAMMPS Commands</A> 
</CENTER>






<HR>

<H3>compute stress/atom command 
</H3>
<P><B>Syntax:</B>
</P>
<PRE>compute ID group-ID stress/atom keyword ... 
</PRE>
<UL><LI>ID, group-ID are documented in <A HREF = "compute.html">compute</A> command
<LI>stress/atom = style name of this compute command
<LI>zero or more keywords may be appended
<LI>keyword = <I>ke</I> or <I>pair</I> or <I>bond</I> or <I>angle</I> or <I>dihedral</I> or <I>improper</I> 
</UL>
<P><B>Examples:</B>
</P>
<PRE>compute 1 mobile stress/atom 
</PRE>
<PRE>compute 1 all stress/atom pair bond 
</PRE>
<P><B>Description:</B>
</P>
<P>Define a computation that computes the symmetric per-atom stress
tensor for each atom in a group.  The tensor for each atom has 6
components: xx, yy, zz, xy, xz, yz.  See the <A HREF = "compute_pressure.html">compute
pressure</A> command if you want the stress tensor
(pressure) of the entire system.  The 6 components can be accessed by
indices 1-6 by any command that uses per-atom computes, e.g. the <A HREF = "dump.html">dump
custom</A> command or <A HREF = "fix_ave_spatial.html">fix ave/spatial</A>
command or <A HREF = "fix_ave_atom.html">fix ave/atom</A> command.  See <A HREF = "Section_howto.html#4_15">this
section</A> for an overview.
</P>
<P>The stress tensor for atom <I>I</I> is given by the following formula,
where <I>a</I> and <I>b</I> take on values x,y,z to generate the 6 components of
the symmetric tensor:
</P>
<CENTER><IMG SRC = "Eqs/stress_tensor.jpg">
</CENTER>
<P>The first term is a kinetic energy contribution for atom <I>I</I>.  The
second term is a pairwise energy contribution where <I>n</I> loops over the
<I>Np</I> neighbors of atom <I>I</I>, <I>r1</I> and <I>r2</I> are the positions of the 2
atoms in the pairwise interaction, and <I>F1</I> and <I>F2</I> are the forces on
the 2 atoms resulting from the pairwise interaction.  The third term
is a bond contribution of similar form for the <I>Nb</I> bonds which atom
<I>I</I> is part of.  The remaining terms are for the <I>Na</I> angle, <I>Nd</I>
dihedral, and <I>Ni</I> improper interactions atom <I>I</I> is part of.
</P>
<P>As the coefficients in the formula imply, a virial contribution
produced by a small set of atoms (e.g. 4 atoms in a dihedral or 3
atoms in a Tersoff 3-body interaction) is assigned in equal portions
to each atom in the set.  E.g. 1/4 of the dihedral virial to each of
the 4 atoms.
</P>
<P>If no extra keywords are listed, all of the terms in this formula are
included in the per-atom stress tensor.  If any extra keywords are
listed, only those terms are summed to compute the tensor.
</P>
<P>Note that the stress for each atom is due to its interaction with all
other atoms in the simulation, not just with other atoms in the group.
</P>
<P>The <A HREF = "dihedral_charmm.html">dihedral_style charmm</A> style calculates
pairwise interactions between 1-4 atoms.  The virial contribution of
these terms is included in the pair virial, not the dihedral virial.
</P>
<P>Note that as defined in the formula, per-atom stress is the negative
of the per-atom pressure tensor.  It is also really a stress-volume
formulation.  It would need to be divided by a per-atom volume to have
units of stress, but an individual atom's volume is not easy to
compute in a deformed solid or a liquid.  Thus, if the diagonal
components of the per-atom stress tensor are summed for all atoms in
the system and the sum is divided by 3V, where V is the volume of the
system, the result should be -P, where P is the total pressure of the
system.
</P>
<P>These lines in an input script should yield that result (assuming
there is no fix or long-range contribution to the stress):
</P>
<PRE>compute		global all pressure thermo_temp
compute		peratom all stress/atom
compute		p all sum peratom
variable	p equal div(add(add(c_p<B>1</B>,c_p<B>2</B>),c_p<B>3</B>),mult(3.0,vol))
thermo_style	custom step temp etotal c_global v_p 
</PRE>
<P>IMPORTANT NOTE: The per-atom stress does NOT include contributions due
to fixes (e.g. <A HREF = "fix_shake.html">SHAKE</A>) or long-range Coulombic
interactions (via the <A HREF = "kspace_style.html">kspace_style</A> command).  The
former needs to be added to LAMMPS.  We're not sure if the latter is
possible to compute.  There are also a few pair styles for manybody
potentials that are not yet instrumented to yield per-atom stress.
See the Restrictions below.
</P>
<P><B>Restrictions:</B>
</P>
<P>These pair styles do not yet tabulate per-atom virial information to
allow them to work with this compute: <A HREF = "pair_airebo.html">airebo</A>,
<A HREF = "pair_meam.html">meam</A>, and <A HREF = "pair_lj.html">TIP4P</A>.
</P>
<P><B>Related commands:</B>
</P>
<P><A HREF = "compute_pe.html">compute pe</A>, <A HREF = "compute_stress_atom.html">compute
stress/atom</A>
</P>
<P><B>Default:</B> none
</P>
</HTML>
