"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Section_commands.html#comm)

:line

compute displace/atom command :h3

[Syntax:]

compute ID group-ID displace/atom fix-ID :pre

ID, group-ID are documented in "compute"_compute.html command
displace/atom = style name of this compute command
fix-ID = ID of a fix of style "coord/original"_fix_coord_original.html :ul

[Examples:]

compute 1 all displace/atom myCoords :pre

[Description:]

Define a computation that calculates the current displacement of each
atom in the group from its original coordinates, including all effects
due to atoms passing thru periodic boundaries.  The original
coordinates are stored by a "fix
coord/original"_fix_coord_original.html command, whose ID must be
specified with this compute.  They are the coordinates at the time the
fix command was issued.

IMPORTANT NOTE: The fix coord/original command stores the initial
coordinates in "unwrapped" form, by using the image flags associated
with each atom.  See the "dump custom"_dump.html command for a
discussion of "unwrapped" coordinates.  See the Atoms section of the
"read_data"_read_data.html command for a discussion of image flags and
how they are set for each atom.  You can reset the image flags
(e.g. to 0) before invoking the fix and this compute by using the "set
image"_set.html command.

The displacements can be output directly via the "dump
custom"_dump.html command.

The value of the displacement will be 0.0 for atoms not in the
specified compute group.  Note that the fix defines its own group and
stores (0.0,0.0,0.0) for the original coordinates of any atom not in
the fix group.

[Output info:]

This compute calculates a vector of length 4 for each atom, which can
be accessed by indices 1-4 by any command that uses per-atom computes
as input.  See "this section"_Section_howto.html#4_15 for an overview
of LAMMPS output options.  The first 3 components of the vector are
the x,y,z displacements.  The 4th component is the total displacement,
i.e. sqrt(dx*dx + dy*dy + dz*dz).

[Restrictions:] none

[Related commands:]

"dump custom"_dump.html, "fix msd"_fix_msd.html

[Default:] none
