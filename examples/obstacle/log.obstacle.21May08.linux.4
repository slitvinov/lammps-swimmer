LAMMPS (21 May 2008)
# 2d LJ obstacle flow

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (51.3743 22.2457 0.321089)
  4 by 1 by 1 processor grid
create_atoms	1 box
Created 840 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
120 atoms in group lower
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
120 atoms in group upper
group		boundary union lower upper
240 atoms in group boundary
group		flow subtract all boundary
600 atoms in group flow

set		group lower type 2
  120 settings made for type
set		group upper type 3
  120 settings made for type

# initial velocities

compute	        mobile flow temp
velocity	flow create 1.0 482748 temp mobile
fix		1 all nve
fix		2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify	2 temp mobile

# Poiselle flow

velocity	boundary set 0.0 0.0 0.0
fix		3 lower setforce 0.0 0.0 0.0
fix		4 upper setforce 0.0 NULL 0.0
fix		5 upper aveforce 0.0 -0.5 0.0
fix		6 flow addforce 1.0 0.0 0.0

# 2 obstacles

region		void1 sphere 10 4 0 3
delete_atoms	region void1
Deleted 36 atoms, new total = 804
region		void2 sphere 20 7 0 3
delete_atoms	region void2
Deleted 35 atoms, new total = 769

fix		7 flow indent 100 sphere 10 4 0 4
fix		8 flow indent 100 sphere 20 7 0 4
fix		9 all enforce2d

# Run

timestep	0.003
thermo		1000
thermo_modify	temp mobile

dump		1 all atom 100 dump.obstacle
#dump		1 all custom 100 dump.custom tag type x y z vx vy 

run		25000
Memory usage per processor = 1.6747 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0    1.0004177            0            0   0.68689281   0.46218884    1142.8674 
    1000            1  -0.31542378            0    0.3711822     1.175277    1269.5736 
    2000            1  -0.41219854            0   0.27440745    1.1491113     1299.751 
    3000            1  -0.47091634            0   0.21568964    1.5138975    1319.4646 
    4000            1  -0.53218028            0    0.1544257    1.4947487    1368.5894 
    5000            1  -0.46667863            0   0.21992736    1.2479263    1416.3743 
    6000            1  -0.48435058            0   0.20225541    1.1547645    1435.6664 
    7000            1  -0.45166298            0   0.23494301    1.2360154    1436.1059 
    8000            1  -0.42767328            0    0.2589327    1.0669461    1445.2577 
    9000            1   -0.3731244            0   0.31348158    1.0759192    1437.8863 
   10000            1  -0.38390694            0   0.30269904    1.0086513    1433.1836 
   11000            1  -0.38602215            0   0.30058383   0.97948448     1433.262 
   12000            1  -0.39324632            0   0.29335966    1.0627957    1439.8189 
   13000            1  -0.38406328            0    0.3025427    1.0506023    1450.2548 
   14000            1  -0.39923996            0   0.28736602    1.0593743    1453.5768 
   15000            1  -0.39243934            0   0.29416664    1.0295791    1451.2386 
   16000            1  -0.39115558            0    0.2954504   0.99442342    1452.2425 
   17000            1  -0.37672706            0   0.30987892    1.1334027    1446.7615 
   18000            1  -0.39587578            0    0.2907302    1.0416836    1451.6676 
   19000            1  -0.37159192            0   0.31501406   0.97004312    1453.7464 
   20000            1  -0.37573625            0   0.31086973    1.0174394    1456.2812 
   21000            1  -0.37788053            0   0.30872545   0.93039844    1468.4444 
   22000            1  -0.38096917            0   0.30563681    1.0034608    1464.2511 
   23000            1  -0.37098283            0   0.31562315   0.98141206    1460.3666 
   24000            1  -0.37160721            0   0.31499877   0.98831948     1462.133 
   25000            1  -0.39191532            0   0.29469067    1.0326092    1457.8187 
Loop time of 7.66898 on 4 procs for 25000 steps with 769 atoms

Pair  time (%) = 0.240548 (3.13664)
Neigh time (%) = 0.0541248 (0.705762)
Comm  time (%) = 3.3025 (43.0631)
Outpt time (%) = 0.277801 (3.6224)
Other time (%) = 3.79401 (49.4721)

Nlocal:    192.25 ave 235 max 157 min
Histogram: 1 1 0 0 0 0 1 0 0 1
Nghost:    42.25 ave 46 max 38 min
Histogram: 1 0 0 0 0 1 1 0 0 1
Neighs:    401.25 ave 540 max 283 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 1605
Ave neighs/atom = 2.08713
Neighbor list builds = 1636
Dangerous builds = 0
