LAMMPS (21 May 2008)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  1 by 1 by 1 processor grid
create_atoms	1 box
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     group lower type 2
  60 settings made for type
set	     group upper type 3
  60 settings made for type

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

#velocity     lower set 0.0 0.0 0.0
#velocity     upper set 3.0 0.0 0.0
#fix	     3 boundary setforce 0.0 0.0 0.0
#fix	     4 all enforce2d

# Poisseuille flow

velocity     boundary set 0.0 0.0 0.0
fix	     3 lower setforce 0.0 0.0 0.0
fix	     4 upper setforce 0.0 NULL 0.0
fix	     5 upper aveforce 0.0 -1.0 0.0
fix	     6 flow addforce 0.5 0.0 0.0
fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 25 dump.flow
run		10000
Memory usage per processor = 1.68525 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71190476    0.5232453    571.43371 
     500    1.0990751  -0.36396768            0   0.41846911    2.5229954    575.44891 
    1000            1  -0.34609791            0   0.36580685    1.9739861    584.56264 
    1500    1.2112861  -0.39062708            0   0.47169327    1.5221639    587.13863 
    2000            1  -0.39956949            0   0.31233527    1.2499009    582.89761 
    2500    1.2236323  -0.40128446            0   0.46982521    1.4279626    569.92814 
    3000            1  -0.48849341            0   0.22341135    1.5094342    553.53722 
    3500    1.2404529  -0.63017441            0   0.25290988    1.7684925    535.11692 
    4000            1  -0.71550459            0 -0.0035998233    2.2080667    516.62241 
    4500    1.2252925  -0.76523375            0   0.10705778    2.6150526    503.09392 
    5000            1  -0.79183795            0 -0.079933193    3.0396463    499.00782 
    5500    1.2154662  -0.76641284            0  0.098883321    2.5749248    501.79835 
    6000            1  -0.64579024            0  0.066114526    2.1632023      511.927 
    6500    1.2040094  -0.67569325            0   0.18144675     1.988296    515.52367 
    7000            1  -0.67495483            0  0.036949936    1.8145292    515.56679 
    7500     1.224424  -0.70211643            0   0.16955688    1.9563915    513.39341 
    8000            1  -0.68750419            0  0.024400573    2.2133264    508.15889 
    8500    1.1991285  -0.81030024            0   0.04336508    2.5391079    501.58914 
    9000            1  -0.79950245            0 -0.087597685    2.5700917    498.68874 
    9500    1.2060053  -0.68460543            0   0.17395548    2.4774286     501.9809 
   10000            1   -0.7187822            0 -0.0068774412    2.1346851    507.66533 
Loop time of 0.73335 on 1 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.235934 (32.1721)
Neigh time (%) = 0.0389028 (5.3048)
Comm  time (%) = 0.0151122 (2.0607)
Outpt time (%) = 0.239849 (32.7059)
Other time (%) = 0.203552 (27.7565)

Nlocal:    420 ave 420 max 420 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    50 ave 50 max 50 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1126 ave 1126 max 1126 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1126
Ave neighs/atom = 2.68095
Neighbor list builds = 560
Dangerous builds = 0
