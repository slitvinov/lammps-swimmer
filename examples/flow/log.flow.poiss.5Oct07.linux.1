LAMMPS (5 Oct 2007)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  1 by 1 by 1 processor grid
create_atoms	1 box
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     group lower type 2
  60 settings made for type
set	     group upper type 3
  60 settings made for type

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

#velocity     lower set 0.0 0.0 0.0
#velocity     upper set 3.0 0.0 0.0
#fix	     3 boundary setforce 0.0 0.0 0.0
#fix	     4 all enforce2d

# Poisseuille flow

velocity     boundary set 0.0 0.0 0.0
fix	     3 lower setforce 0.0 0.0 0.0
fix	     4 upper setforce 0.0 NULL 0.0
fix	     5 upper aveforce 0.0 -1.0 0.0
fix	     6 flow addforce 0.5 0.0 0.0
fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 25 dump.flow
run		10000
Memory usage per processor = 1.34193 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429    0.5223703    571.43371 
     500    1.1036177  -0.37435595            0    0.4100009    2.5048411    575.42182 
    1000            1  -0.40278179            0   0.30793249    1.9811241    584.83497 
    1500    1.2346487  -0.41204291            0   0.46543956    1.5657713    586.36408 
    2000            1  -0.40773469            0    0.3029796      1.46174    583.54346 
    2500    1.2225527  -0.43831252            0   0.43057314    1.4819315    570.69513 
    3000            1  -0.49535278            0   0.21536151    1.5237868    553.26289 
    3500    1.2493782   -0.5997175            0   0.28823343    1.6851599    536.49066 
    4000            1  -0.67585271            0  0.034861579    2.0031708    518.19517 
    4500    1.1920623  -0.75096037            0  0.096255336    2.9347272    502.79894 
    5000            1  -0.82965482            0  -0.11894053    3.1069174    498.40593 
    5500    1.1922661  -0.78951149            0  0.057849031    3.0213496    502.16585 
    6000            1   -0.7308371            0 -0.020122809     2.394881    511.15935 
    6500    1.2295832  -0.71069261            0   0.16318977     1.971859    519.77333 
    7000            1  -0.64017925            0  0.070535035    2.0286235    520.82147 
    7500    1.2330112  -0.64928351            0   0.22703517     1.899572    518.70836 
    8000            1  -0.62643742            0  0.084276866    1.8527516     514.8535 
    8500    1.2117799  -0.71296056            0   0.14826876     2.280841    506.58294 
    9000            1  -0.72064639            0 -0.0099321068    2.2778589     504.4823 
    9500    1.2309735  -0.77916374            0  0.095706684    2.3907829    498.66444 
   10000            1   -0.7626132            0 -0.051898912    2.4826365    501.23793 
Loop time of 0.723683 on 1 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.235178 (32.4974)
Neigh time (%) = 0.0384169 (5.30852)
Comm  time (%) = 0.0161228 (2.22788)
Outpt time (%) = 0.238223 (32.9181)
Other time (%) = 0.195742 (27.0481)

Nlocal:    420 ave 420 max 420 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    48 ave 48 max 48 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    1144 ave 1144 max 1144 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1144
Ave neighs/atom = 2.72381
Neighbor list builds = 560
Dangerous builds = 0
