LAMMPS (7 Jul 2009)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  2 by 2 by 1 processor grid
create_atoms	1 box
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     group lower type 2
  60 settings made for type
set	     group upper type 3
  60 settings made for type

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

velocity     lower set 0.0 0.0 0.0
velocity     upper set 3.0 0.0 0.0
fix	     3 boundary setforce 0.0 0.0 0.0
fix	     4 all enforce2d

# Poisseuille flow

#velocity     boundary set 0.0 0.0 0.0
#fix	     3 lower setforce 0.0 0.0 0.0
#fix	     4 upper setforce 0.0 NULL 0.0
#fix	     5 upper aveforce 0.0 -1.0 0.0
#fix	     6 flow addforce 0.5 0.0 0.0
#fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 50 dump.flow
run		10000
Memory usage per processor = 1.67714 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71190476    0.5232453    571.43371 
     500    1.0951876  -0.33403931            0   0.44562996    3.2508527    571.43371 
    1000            1   -0.3731019            0   0.33880286     2.856717    571.43371 
    1500    1.0366879  -0.36031105            0   0.37771198    3.0202123    571.43371 
    2000            1  -0.41052951            0   0.30137525    2.8657415    571.43371 
    2500    1.1228466  -0.37043294            0   0.42892693    2.9450302    571.43371 
    3000            1  -0.37926849            0   0.33263627    2.5756937    571.43371 
    3500    1.0426371  -0.46446342            0   0.27779493    2.6309178    571.43371 
    4000            1  -0.43996746            0    0.2719373    2.7108953    571.43371 
    4500   0.97471021  -0.43234275            0   0.26155809    2.4118441    571.43371 
    5000            1  -0.38709789            0   0.32480687    2.6100243    571.43371 
    5500    1.0551901  -0.42334943            0   0.32784545    2.4333785    571.43371 
    6000            1  -0.45014484            0   0.26175993    2.5188073    571.43371 
    6500    1.0439428  -0.46442749            0   0.27876034    2.2352899    571.43371 
    7000            1  -0.42616126            0    0.2857435    2.4560563    571.43371 
    7500    1.0680429  -0.41282904            0   0.34751579    2.5532595    571.43371 
    8000            1  -0.44461273            0   0.26729203    2.1838508    571.43371 
    8500    1.0212571  -0.43065547            0   0.29638229    2.2193889    571.43371 
    9000            1  -0.43364252            0   0.27826224    2.4244927    571.43371 
    9500    1.1269004  -0.48721451            0   0.31503125    2.3601218    571.43371 
   10000            1  -0.50814904            0   0.20375572    2.3234126    571.43371 
Loop time of 3.45458 on 4 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.0726623 (2.10336)
Neigh time (%) = 0.0228513 (0.661479)
Comm  time (%) = 2.63741 (76.3452)
Outpt time (%) = 0.164288 (4.75566)
Other time (%) = 0.55737 (16.1343)

Nlocal:    105 ave 116 max 93 min
Histogram: 1 1 0 0 0 0 0 0 0 2
Nghost:    40.25 ave 43 max 36 min
Histogram: 1 0 0 0 1 0 0 0 0 2
Neighs:    238.75 ave 307 max 175 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 955
Ave neighs/atom = 2.27381
Neighbor list builds = 967
Dangerous builds = 0
