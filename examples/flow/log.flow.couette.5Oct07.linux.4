LAMMPS (5 Oct 2007)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  2 by 2 by 1 processor grid
create_atoms	1 box
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     group lower type 2
  60 settings made for type
set	     group upper type 3
  60 settings made for type

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

velocity     lower set 0.0 0.0 0.0
velocity     upper set 3.0 0.0 0.0
fix	     3 boundary setforce 0.0 0.0 0.0
fix	     4 all enforce2d

# Poisseuille flow

#velocity     boundary set 0.0 0.0 0.0
#fix	     3 lower setforce 0.0 0.0 0.0
#fix	     4 upper setforce 0.0 NULL 0.0
#fix	     5 upper aveforce 0.0 -1.0 0.0
#fix	     6 flow addforce 0.5 0.0 0.0
#fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 50 dump.flow
run		10000
Memory usage per processor = 1.33382 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429    0.5223703    571.43371 
     500    1.0967867   -0.3465085            0   0.43299345    3.2514265    571.43371 
    1000            1  -0.36129869            0    0.3494156    3.1353617    571.43371 
    1500    1.1299217  -0.37859354            0   0.42445794    2.9270341    571.43371 
    2000            1  -0.34287506            0   0.36783923    3.0258649    571.43371 
    2500    1.0916596   -0.3872134            0   0.38864469    2.8426168    571.43371 
    3000            1  -0.42816199            0    0.2825523    2.7129793    571.43371 
    3500   0.94744822  -0.47483071            0   0.19853427    2.7259788    571.43371 
    4000            1   -0.3684736            0   0.34224069    2.6328623    571.43371 
    4500   0.99502131  -0.37808208            0   0.32909378    2.5909215    571.43371 
    5000            1  -0.41230276            0   0.29841152    2.9229369    571.43371 
    5500    1.0560855  -0.48401682            0   0.26655822     2.472482    571.43371 
    6000            1   -0.4068915            0   0.30382279    2.3428133    571.43371 
    6500    1.0437572  -0.41914338            0   0.32266981    2.6151758    571.43371 
    7000            1  -0.42595992            0   0.28475437    2.3109881    571.43371 
    7500    1.0600587    -0.336143            0   0.41725588    2.3511832    571.43371 
    8000            1  -0.40369591            0   0.30701838    2.6195769    571.43371 
    8500    1.0750756  -0.43763885            0   0.32643275    2.2469938    571.43371 
    9000            1  -0.44198063            0   0.26873366    2.5250617    571.43371 
    9500    1.0263815  -0.43395816            0   0.29550586    2.5922753    571.43371 
   10000            1  -0.47197889            0   0.23873539    2.4144186    571.43371 
Loop time of 3.80719 on 4 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.0669479 (1.75846)
Neigh time (%) = 0.0220439 (0.579009)
Comm  time (%) = 2.96294 (77.825)
Outpt time (%) = 0.160523 (4.21632)
Other time (%) = 0.594731 (15.6213)

Nlocal:    105 ave 116 max 95 min
Histogram: 2 0 0 0 0 0 0 0 1 1
Nghost:    41.75 ave 46 max 39 min
Histogram: 1 0 2 0 0 0 0 0 0 1
Neighs:    237.5 ave 301 max 178 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 950
Ave neighs/atom = 2.2619
Neighbor list builds = 973
Dangerous builds = 0
