LAMMPS (5 Oct 2007)
# 2-d LJ flow simulation

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 20 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (25.6871 22.2457 0.321089)
  2 by 2 by 1 processor grid
create_atoms	1 box
Created 420 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	     1 block INF INF INF 1.25 INF INF
group	     lower region 1
60 atoms in group lower
region	     2 block INF INF 8.75 INF INF INF
group	     upper region 2
60 atoms in group upper
group	     boundary union lower upper
120 atoms in group boundary
group	     flow subtract all boundary
300 atoms in group flow

set	     group lower type 2
  60 settings made for type
set	     group upper type 3
  60 settings made for type

# initial velocities

compute	     mobile flow temp
velocity     flow create 1.0 482748 temp mobile
fix	     1 all nve
fix	     2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify   2 temp mobile

# Couette flow

#velocity     lower set 0.0 0.0 0.0
#velocity     upper set 3.0 0.0 0.0
#fix	     3 boundary setforce 0.0 0.0 0.0
#fix	     4 all enforce2d

# Poisseuille flow

velocity     boundary set 0.0 0.0 0.0
fix	     3 lower setforce 0.0 0.0 0.0
fix	     4 upper setforce 0.0 NULL 0.0
fix	     5 upper aveforce 0.0 -1.0 0.0
fix	     6 flow addforce 0.5 0.0 0.0
fix	     7 all enforce2d

# Run

timestep	0.003
thermo		500
thermo_modify	temp mobile

dump		1 all atom 25 dump.flow
run		10000
Memory usage per processor = 1.33382 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0            1            0            0   0.71071429    0.5223703    571.43371 
     500    1.0778761  -0.35048279            0   0.41557918    2.7734524    574.92238 
    1000            1  -0.38740705            0   0.32330724    2.1851606    585.40362 
    1500    1.2052679  -0.37768559            0   0.47891551    1.5598219    585.77368 
    2000            1  -0.38060118            0   0.33011311    1.4422178    578.14206 
    2500    1.2211447  -0.39689947            0   0.47098548    1.5039485    566.96926 
    3000            1  -0.46632695            0   0.24438733    1.5055761    554.63863 
    3500    1.2338306  -0.57219064            0   0.30471041     1.750976    537.18508 
    4000            1  -0.70062676            0   0.01008753    2.2214089    518.64479 
    4500    1.2113785  -0.71432757            0   0.14661646     2.924362    503.68263 
    5000            1  -0.75295272            0 -0.042238438    3.0703778    500.62274 
    5500    1.2231978   -0.7326692            0   0.13667498    2.4722796    507.17803 
    6000            1  -0.69221877            0  0.018495519    2.1186078    514.07585 
    6500    1.2130182  -0.64829278            0   0.21381659     2.025108    517.78662 
    7000            1  -0.65011103            0   0.06060326    1.9907035    517.57821 
    7500    1.2244611  -0.68871579            0    0.1815262    2.1613555    512.52321 
    8000            1  -0.70033438            0  0.010379908    2.1994922    511.09769 
    8500    1.2325381  -0.73996991            0   0.13601255    2.2631942    507.50923 
    9000            1  -0.72281872            0 -0.012104437    2.4807895    504.20901 
    9500    1.2301783  -0.74960296            0    0.1247023    2.4156775     505.4057 
   10000            1  -0.76295913            0  -0.05224484    2.3054863    506.85774 
Loop time of 4.92595 on 4 procs for 10000 steps with 420 atoms

Pair  time (%) = 0.0711665 (1.44473)
Neigh time (%) = 0.0116335 (0.236168)
Comm  time (%) = 3.0335 (61.582)
Outpt time (%) = 0.295245 (5.99366)
Other time (%) = 1.51441 (30.7435)

Nlocal:    105 ave 106 max 104 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:    44.5 ave 46 max 43 min
Histogram: 1 0 0 1 0 0 1 0 0 1
Neighs:    277.25 ave 292 max 254 min
Histogram: 1 0 0 0 1 0 0 0 0 2

Total # of neighbors = 1109
Ave neighs/atom = 2.64048
Neighbor list builds = 558
Dangerous builds = 0
